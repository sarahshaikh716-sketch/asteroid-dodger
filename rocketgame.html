<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rocket Asteroid Dodger</title>
  <style>
    body { margin: 0; overflow: hidden; background: #000; }
    canvas { display: block; background: #000; margin: 0 auto; }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="480"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

// Rocket/game variables
let rocketY = canvas.height / 2;
let targetRocketY = rocketY;
const rocketX = 80;
const rocketBodyLength = 78; // longer rocket
const rocketBodyWidth = 20;
const rocketNoseLength = 22;
const rocketFinLength = 22;
const rocketFinWidth = 9;
const rocketMoveSpeed = 12;
let isPlaying = false;
let isStartScreen = true;
let isGameOver = false;
let asteroids = [];
let asteroidSpeed = 3.2;
let minAsteroidGapY = 110;
let score = 0;
let highScore = 0;

// Background stars
const starCount = 85;
let stars = [];
for (let i = 0; i < starCount; i++) {
  stars.push({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    r: Math.random() * 1.5 + 0.5,
    alpha: Math.random()
  });
}
function drawStars() {
  for (let s of stars) {
    ctx.save();
    ctx.globalAlpha = 0.7 + 0.3 * Math.sin(Date.now() / 250 + s.x + s.y);
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
    ctx.fillStyle = '#fff';
    ctx.fill();
    ctx.restore();
  }
}

// Rocket: long white body, red head, two wings on each side (total four)
function drawRocket(y) {
  ctx.save();
  ctx.translate(rocketX, y);

  // Four wings/fins - two top, two bottom
  for (let side = -1; side <= 1; side += 2) {
    for (let vert = -1; vert <= 1; vert += 2) {
      ctx.save();
      ctx.beginPath();
      let finStartX = -rocketBodyLength/2 + rocketFinLength/2;
      ctx.moveTo(finStartX, side * rocketBodyWidth/2 * 0.7);
      ctx.lineTo(finStartX - rocketFinLength, side * (rocketBodyWidth/2 + rocketFinWidth * vert));
      ctx.lineTo(finStartX, side * (rocketBodyWidth/2 + rocketFinWidth/2 * vert));
      ctx.closePath();
      ctx.fillStyle = '#e94f4f';
      ctx.globalAlpha = 0.88;
      ctx.fill();
      ctx.restore();
    }
  }

  // Body (white and long)
  ctx.beginPath();
  ctx.moveTo(-rocketBodyLength/2, -rocketBodyWidth/2);
  ctx.lineTo(rocketBodyLength/2, -rocketBodyWidth/2);
  ctx.lineTo(rocketBodyLength/2, rocketBodyWidth/2);
  ctx.lineTo(-rocketBodyLength/2, rocketBodyWidth/2);
  ctx.closePath();
  ctx.fillStyle = '#f7f7f7';
  ctx.shadowColor = '#bbb';
  ctx.shadowBlur = 8;
  ctx.fill();
  ctx.strokeStyle = '#cccccc';
  ctx.lineWidth = 2;
  ctx.stroke();

  // Red pointed head/nose cone
  ctx.beginPath();
  ctx.moveTo(rocketBodyLength/2, -rocketBodyWidth/2);
  ctx.lineTo(rocketBodyLength/2 + rocketNoseLength, 0);
  ctx.lineTo(rocketBodyLength/2, rocketBodyWidth/2);
  ctx.closePath();
  ctx.fillStyle = '#e53232';
  ctx.shadowColor = '#e53232';
  ctx.shadowBlur = 10;
  ctx.fill();
  ctx.strokeStyle = '#aa2020';
  ctx.lineWidth = 2;
  ctx.stroke();

  // Window/glass
  ctx.beginPath();
  ctx.ellipse(rocketBodyLength/4, 0, 9, 6, 0, 0, Math.PI * 2);
  let gradWindow = ctx.createRadialGradient(rocketBodyLength/4, 0, 2, rocketBodyLength/4, 0, 7);
  gradWindow.addColorStop(0, '#9feaff');
  gradWindow.addColorStop(1, '#477fa5');
  ctx.globalAlpha = 0.84;
  ctx.fillStyle = gradWindow;
  ctx.fill();
  ctx.globalAlpha = 1;
  ctx.strokeStyle = '#415af3';
  ctx.lineWidth = 1.5;
  ctx.stroke();

  // Realistic animated fire
  let time = Date.now() * 0.007;
  for (let layer = 0; layer < 3; layer++) {
    ctx.save();
    ctx.beginPath();
    ctx.moveTo(-rocketBodyLength/2, -6);
    for (let i = 0; i <= 10; i++) {
      let flameLen = 21 + 8 * layer + 7 * Math.sin(time + i * (1.2 + 0.7 * layer));
      let flameX = -rocketBodyLength/2 - flameLen;
      let flameY = -6 + i * 1.2 + Math.sin(time * 1.2 + i + layer * 1.9) * (2.8 + layer);
      ctx.lineTo(flameX, flameY);
    }
    ctx.lineTo(-rocketBodyLength/2, 6);
    ctx.closePath();
    let grad = ctx.createLinearGradient(-rocketBodyLength/2 - 28, 0, -rocketBodyLength/2 - 2, 0);
    if (layer === 0) {
      grad.addColorStop(0, "#fff7b1");
      grad.addColorStop(0.8, "#ffe07a");
      grad.addColorStop(1, "#ffa12e");
    } else if (layer === 1) {
      grad.addColorStop(0, "#ffa12e");
      grad.addColorStop(0.8, "#fd4c3b");
      grad.addColorStop(1, "#f21818");
    } else {
      grad.addColorStop(0, "#fd4c3b");
      grad.addColorStop(0.8, "#a81313");
      grad.addColorStop(1, "#721616");
    }
    ctx.globalAlpha = 0.32 + 0.33 * (1.0 - layer / 3);
    ctx.fillStyle = grad;
    ctx.shadowColor = "#fd892e";
    ctx.shadowBlur = 12 - layer * 3;
    ctx.fill();
    ctx.restore();
  }
  ctx.restore();
}

// Asteroids (same as previous, prettified)
function drawAsteroid(x, y, r, seed = 1) {
  ctx.save();
  let steps = 12 + Math.floor(Math.random() * 4);
  let points = [];
  for (let i = 0; i < steps; i++) {
    let angle = (Math.PI * 2 / steps) * i;
    let rad = r + Math.sin(angle * seed + seed * 2) * r / 2 * Math.random();
    let ax = x + Math.cos(angle) * rad;
    let ay = y + Math.sin(angle) * rad;
    points.push({x: ax, y: ay});
    if (i === 0) ctx.moveTo(ax, ay); else ctx.lineTo(ax, ay);
  }
  ctx.closePath();

  // Gradient fill for rocky look
  let grad = ctx.createRadialGradient(x, y, r * 0.4, x, y, r * 1.2);
  grad.addColorStop(0, '#bdb9bd');
  grad.addColorStop(0.5, '#716870');
  grad.addColorStop(0.8, '#43414f');
  grad.addColorStop(1, '#23212a');
  ctx.fillStyle = grad;
  ctx.shadowColor = '#222';
  ctx.shadowBlur = 14;
  ctx.fill();
  ctx.strokeStyle = '#39354a';
  ctx.lineWidth = 2;
  ctx.stroke();

  // Holes and highlights
  let holes = Math.floor(Math.random() * 3) + 2;
  for (let h = 0; h < holes; h++) {
    let phi = Math.random() * Math.PI * 2;
    let rad = r * (0.25 + Math.random() * 0.4);
    let hx = x + Math.cos(phi) * rad * (0.65 + Math.random() * 0.4);
    let hy = y + Math.sin(phi) * rad * (0.65 + Math.random() * 0.4);
    ctx.beginPath();
    ctx.arc(hx, hy, 6 + Math.random() * 9, 0, Math.PI * 2);
    ctx.fillStyle = '#181723';
    ctx.globalAlpha = 0.65;
    ctx.fill();
    ctx.globalAlpha = 1;
    ctx.beginPath();
    ctx.arc(hx + 3, hy + 2, 2 + Math.random() * 2, 0, Math.PI * 2);
    ctx.fillStyle = '#cdc8e0';
    ctx.globalAlpha = 0.32;
    ctx.fill();
    ctx.globalAlpha = 1;
  }
  ctx.restore();
}

// Asteroid generation
function addAsteroid() {
  let safeMargin = 35;
  let lastY = asteroids.length ? asteroids[asteroids.length - 1].y : canvas.height / 2;
  let possibleY = [];
  for (let i = safeMargin; i < canvas.height - safeMargin; i += 10) {
    if (Math.abs(i - lastY) > minAsteroidGapY) {
      possibleY.push(i);
    }
  }
  let yIndex = Math.floor(Math.random() * possibleY.length);
  let astY = possibleY[yIndex];
  asteroids.push({
    x: canvas.width + 40,
    y: astY,
    r: 32 + Math.random() * 10,
    seed: Math.random() * 8,
    passed: false
  });
}

// Score panel
function showScore() {
  ctx.save();
  ctx.fillStyle = '#fff';
  ctx.font = 'bold 26px Arial';
  ctx.textAlign = 'right';
  ctx.fillText(score, canvas.width - 26, 44);
  ctx.font = '16px Arial';
  ctx.fillText('High: ' + highScore, canvas.width - 26, 68);
  ctx.restore();
}

// Start screen
function drawStartScreen() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawStars();
  ctx.font = 'bold 36px Arial';
  ctx.fillStyle = '#fff';
  ctx.textAlign = 'center';
  ctx.fillText('Rocket Asteroid Dodger', canvas.width / 2, canvas.height / 3);

  ctx.font = '22px Arial';
  ctx.fillText('Press SPACE to start the game!', canvas.width / 2, canvas.height / 2);

  ctx.font = '17px Arial';
  ctx.fillStyle = '#ffb900';
  ctx.fillText('Use ↑ (Up) and ↓ (Down) arrow keys to glide the rocket up and down.', canvas.width / 2, canvas.height / 2 + 30);

  ctx.font = '14px Arial';
  ctx.fillStyle = '#aaa';
  ctx.fillText('Game Over if the rocket touches top/bottom or hits an asteroid.', canvas.width / 2, canvas.height / 2 + 54);

  drawRocket(canvas.height / 2 + 85);
}

// Game loop
function animate() {
  if (!isPlaying) return;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawStars();

  // Smooth rocket movement (lerp towards targetRocketY)
  rocketY += (targetRocketY - rocketY) * 0.32;

  // Check top/bottom collision
  if (rocketY - rocketBodyWidth / 2 - rocketFinWidth/2 < 0 || rocketY + rocketBodyWidth / 2 + rocketFinWidth/2 > canvas.height) {
    endGame();
    return;
  }

  // Add asteroids
  if (asteroids.length === 0 || asteroids[asteroids.length - 1].x < canvas.width - 180) {
    addAsteroid();
  }

  // Move and draw asteroids
  for (let i = 0; i < asteroids.length; i++) {
    let ast = asteroids[i];
    ast.x -= asteroidSpeed;
    drawAsteroid(ast.x, ast.y, ast.r, ast.seed);

    // Collision detection
    if (detectCollision(ast.x, ast.y, ast.r)) {
      endGame();
      return;
    }

    // Score update
    if (!ast.passed && ast.x + ast.r < rocketX - 22) {
      score++;
      ast.passed = true;
      if (score > highScore) highScore = score;
    }
  }

  // Remove off-screen asteroids
  if (asteroids.length > 0 && asteroids[0].x < -asteroids.r) {
    asteroids.shift();
  }

  drawRocket(rocketY);
  showScore();

  requestAnimationFrame(animate);
}

// Rocket/asteroid collision
function detectCollision(x, y, r) {
  let dx = x - rocketX;
  let dy = y - rocketY;
  let bounding = Math.max(rocketBodyWidth, rocketFinLength, rocketNoseLength);
  let dist = Math.sqrt(dx * dx + dy * dy);
  return dist < r + bounding;
}

// Game over screen
function endGame() {
  isPlaying = false;
  isGameOver = true;
  ctx.fillStyle = '#000';
  ctx.globalAlpha = 0.92;
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  ctx.globalAlpha = 1;
  ctx.font = 'bold 47px Arial';
  ctx.fillStyle = '#fff';
  ctx.textAlign = 'center';
  ctx.fillText('Game Over!', canvas.width / 2, canvas.height / 2 - 40);
  ctx.font = '23px Arial';
  ctx.fillText('Score: ' + score, canvas.width / 2, canvas.height / 2 - 10);
  ctx.fillText('Highest Score: ' + highScore, canvas.width / 2, canvas.height / 2 + 22);
  ctx.font = '16px Arial';
  ctx.fillStyle = '#f25d30';
  ctx.fillText('Press SPACE to play again.', canvas.width / 2, canvas.height / 2 + 54);
}

// Keyboard interaction
window.addEventListener('keydown', (e) => {
  if ((isStartScreen || isGameOver) && e.code === 'Space') {
    isPlaying = true;
    isStartScreen = false;
    isGameOver = false;
    asteroids = [];
    score = 0;
    rocketY = canvas.height / 2;
    targetRocketY = rocketY;
    animate();
  } else if (isPlaying) {
    if (e.code === 'ArrowUp')   targetRocketY = Math.max(rocketBodyWidth/2 + rocketFinWidth/2, targetRocketY - rocketMoveSpeed);
    if (e.code === 'ArrowDown') targetRocketY = Math.min(canvas.height - rocketBodyWidth/2 - rocketFinWidth/2, targetRocketY + rocketMoveSpeed);
  }
});

// Initial draw
drawStartScreen();
</script>
</body>
</html>
